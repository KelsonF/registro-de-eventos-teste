{% extends 'base.html' %}

{% block title %}Detalhes do Evento - {{ event.name }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-3xl">
  <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
    <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">{{ event.name }}</h1>
    <p class="text-gray-600 mb-2"><strong>Data:</strong> {{ event.date|date:"d M, Y - H:i" }}</p>
    <p class="text-gray-600 mb-2"><strong>Local:</strong> {{ event.location }}</p>
    {% if event.description %}
    <p class="text-gray-700 mb-4">{{ event.description }}</p>
    {% endif %}
    <p class="text-sm text-gray-500 mb-6 wrap-break-words">
      <strong>Código de Acesso:</strong> <span class="font-mono">{{ event.access_code }}</span>
    </p>

    <h2 class="text-xl md:text-2xl font-semibold mb-4">Resumo da Presença</h2>
    <ul class="mb-6 space-y-2">
      <li><strong>Convidados Confirmados:</strong> {{ total_confirmed }}</li>
      <li><strong>Recusados:</strong> {{ total_declined }}</li>
      <li><strong>Total de Pessoas Confirmadas:</strong> {{ total_guests }}</li>
    </ul>

    <h3 class="text-lg md:text-xl font-semibold mb-4">Lista de Convidados</h3>
    {% if attendances %}
    <div class="overflow-x-auto">
      <table class="min-w-full text-left border border-gray-200">
        <thead class="bg-gray-100">
          <tr>
            <th class="py-3 px-4 border-b border-gray-200">Nome do Convidado</th>
            <th class="py-3 px-4 border-b border-gray-200">Status</th>
            <th class="py-3 px-4 border-b border-gray-200">Número de Pessoas</th>
            <th class="py-3 px-4 border-b border-gray-200">Observações</th>
            <th class="py-3 px-4 border-b border-gray-200">Confirmado em</th>
          </tr>
        </thead>
        <tbody>
          {% for attendance in attendances %}
          <tr class="border-t border-gray-200">
            <td class="py-2 px-4">{{ attendance.guest_name }}</td>
            <td class="py-2 px-4">
              {% if attendance.status == "confirmed" %}
              <span class="text-green-600 font-semibold">Confirmado</span>
              {% else %}
              <span class="text-red-600 font-semibold">Recusado</span>
              {% endif %}
            </td>
            <td class="py-2 px-4">{{ attendance.total_guests }}</td>
            <td class="py-2 px-4">{{ attendance.notes|default:"-" }}</td>
            <td class="py-2 px-4">{{ attendance.confirmation_date|date:"d M, Y H:i" }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <p>Ainda não há respostas.</p>
    {% endif %}

    <div class="mt-8 flex flex-col md:flex-row gap-4">
      <a href="{% url 'event-list' %}"
        class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-3 px-6 rounded text-center">
        Voltar aos Eventos
      </a>
      <a href="{% url 'event-update' event.pk %}"
        class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded text-center">
        Editar Evento
      </a>
    </div>
  </div>
</div>
{% endblock content %}